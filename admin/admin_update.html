<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin_Update</title>
    <script src="https://cdn.firebase.com/js/client/2.2.7/firebase.js"></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>
    <script src="../js/search.js" type="text/javascript"></script>

    <link href="../css/style.css" rel="stylesheet" />
    <link rel="shortcut icon" href="../img/icon2.ico" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="HTML Reference Website" />
    <meta name="author" content="PoweredByCoffee" />

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body>
    <h1 id="mainHeader"></h1>
    <header>
        <nav>
            <div class="nav_container">
                <ul>
                    <li class="logo">
                        <a href="index.html">&lt; Powered By Coffee &gt;HTML Reference</a>
                    </li>
                    <li>
                        <a style="margin-left:5px;" href="../index.html">Home</a>
                    </li>
                    <li class="active">
                        <a href="#">About</a>
                    </li>
                    <li>
                        <a href="../contact.html">Contact</a>
                    </li>
                    <li>
                        <input style="margin-left:30px;" type="text" id="s_tagName" placeholder="Search" onkeydown="search_by_enter()" />
                        <button id="searchBut" class="goButton" value="submit" onclick="search_tag()"> Go </button>
                    </li>
                </ul>
            </div>
            <!--/.nav-collapse -->
        </nav>
    </header>



<script>


    var queryString = window.location.search;
    var start = queryString.indexOf("=");
    var end = queryString.indexOf("&");
    var tag = queryString.slice(start + 1, end);


    document.getElementById("mainHeader").innerHTML = "Main Info" + tag;


    var descriptionRef = new Firebase("https://poweredbycoffee1.firebaseio.com/description/" + tag);
    var browserRef = new Firebase("https://poweredbycoffee1.firebaseio.com/browser/" + tag);
    var exampleRef = new Firebase("https://poweredbycoffee1.firebaseio.com/example/" + tag);

    var attributeRef = new Firebase("https://poweredbycoffee1.firebaseio.com/attribute/" + tag);

    
    var categoryRef = new Firebase("https://poweredbycoffee1.firebaseio.com/category/");


    descriptionRef.once("value", function(snapshot) {

        var data = snapshot.val();

        field = document.getElementById("tagName");
        field.value = tag;

        field = document.getElementById("tagDescriptionShort");
        field.value = data.short_description;

        field = document.getElementById("tagDescriptionLong");
        field.value = data.long_description;
    });

    exampleRef.once("value", function(snapshot) {

        var data = snapshot.val();

        field = document.getElementById("tagExampleCode");
        field.value = data.html_code;

        field = document.getElementById("tagExampleRaw");
        field.value = data.html_raw;
    });

    attributeRef.once("value", function(snapshot) {

	snapshot.forEach(function(childSnapshot) {
		var childData = childSnapshot.val();
		field = document.getElementById("tagAttributes");
		field.value += childData.name + ",";
	});

	field.value = field.value.substring(0, field.value.length - 1);

    });

    categoryRef.once("value", function(snapshot) {
    	snapshot.forEach(function(childSnapshot) {
		childSnapshot.forEach(function(childchildSnapshot) {

			var childchildData = childchildSnapshot.val();
			field = document.getElementById("tagCategory");
			if(childchildData.name == tag) {
				field = document.getElementById("tagCategory");
				field.value = childSnapshot.key();
			}
		});
	});
    });

    browserRef.once("value", function(snapshot) {

        var data = snapshot.val();

        field = document.getElementById("ieBrowser");
        field.value = data.internet_explorer;

        field = document.getElementById("firefoxBrowser");
        field.value = data.firefox;

        field = document.getElementById("chromeBrowser");
        field.value = data.chrome;

        field = document.getElementById("safariBrowser");
        field.value = data.opera;

        field = document.getElementById("operaBrowser");
        field.value = data.safari;
    });

    function add_tag() {
        var descriptionRef_add = new Firebase("https://poweredbycoffee1.firebaseio.com/description/");
        var browserRef_add = new Firebase("https://poweredbycoffee1.firebaseio.com/browser/");
        var exampleRef_add = new Firebase("https://poweredbycoffee1.firebaseio.com/example/");

        var tagName = $('#tagName').val();
        var tagDescriptionShort = $('#tagDescriptionShort').val();
        var tagDescriptionLong = $('#tagDescriptionLong').val();
        var tagExampleCode = $('#tagExampleCode').val();
        var tagExampleRaw = $('#tagExampleRaw').val();
	var tagAttributes = $('$tagAttributes').val();
        var ieBrowser = $('#ieBrowser').val();
        var firefoxBrowser = $('#firefoxBrowser').val();
        var chromeBrowser = $('#chromeBrowser').val();
        var safariBrowser = $('#safariBrowser').val();
        var operaBrowser = $('#operaBrowser').val();



        descriptionRef_add.child(tagName).set({
            short_description: tagDescriptionShort,
            long_description: tagDescriptionLong
        });


        browserRef_add.child(tagName).set({
            internet_explorer: ieBrowser,
            firefox: firefoxBrowser,
            chrome: chromeBrowser,
            safari: safariBrowser,
            opera: operaBrowser
        });


        exampleRef_add.child(tagName).set({
            html_code: tagExampleCode,
            html_raw: tagExampleRaw
        });

	var attributes = tagAttributes.split(',');
	for(i=0; i < attributes.length; i++) {
		if (attributes[i] == "global") {
			var globalA = [
				"accesskey",
				"class",
				"contenteditable",
				"contextmenu",
				"data-*",
				"dir",
				"draggable",
				"dropzone",
				"hidden",
				"id",
				"lang",
				"spellcheck",
				"style",
				"tabindex",
				"title",
				"translate",
			];
			
			console.log(globalA);                        
			for(j=0; j < globalA.length; j++) {
			
				attributeRef.child(tagName).push({
					name: globalA[j]
				});
			}
								
		}
		else {
			attributeRef.child(tagName).push({
				name: attributes[i]
			});
		}
	}

        alert("Added " + tagName);
    }

</script>
    <div class="outer_container" id="admin_page">
        <p class="top-label" style="box-shadow: 0px 3px 10px #888888;">Update Tag</p>
        <br />
        <br />
        <!--<h2 style="box-shadow:0 0 5px #5f5f5f; ">Main Info</h2>-->
        <p class="sub-label">Main Info</p>
        <form method="post" onsubmit="add_tag()">
            <ul class="input_admin">
                <li>
                    <label for="tagName">Tag Name:</label>
                    <input class="input_text" type="text" id="tagName" placeholder="br, table, form, etc.">
                    <br>
                    <br>
                </li>

                <li>
                    <label for="tagDescriptionShort">Tag Description (Short):</label>
                    <input type="text" id="tagDescriptionShort" placeholder="type description here">
                    <br>
                    <br>
                </li>
                <li>
                    <label id="fake"for="tagDescriptionLong">Tag Description (Long):</label>
                    <textarea id="tagDescriptionLong" rows="5" cols="width" placeholder="Type long description here"></textarea>
                    <br>
                    <br>
                </li>
                <li>
                    <label for="tagExampleCode">Tag Example (html code here):</label>
                    <textarea id="tagExampleCode" rows="5" cols="50" placeholder="Type HTML code here"></textarea>
                    <br>
                    <br>
                </li>
                <li>
                    <label for="tagExampleRaw">Tag Example (html formatted):</label>
                    <textarea id="tagExampleRaw" rows="5" cols="50" placeholder="Type HTML code for browser ouput"></textarea>
                    <br>
                    <br>
                </li>
                <li>
                    <label for="tagAttributes">Attribute (comma seperate):</label>
                    <input type="text" id="tagAttributes" placeholder="global, color, bgcolor, etc">
                </li>
                </ul>

                <p class="sub-label">Browser Support Section</p>

                <ul class="input_admin">

                    <li>
                        <label for="ieBrowser">Internet Explorer:</label>
                        <input type="text" id="ieBrowser" placeholder="Yes/No or Number">
                        <br>
                        <br>
                    </li>
                    <li>
                        <label for="firefoxBrowser">Firefox:</label>
                        <input type="text" id="firefoxBrowser" placeholder="Yes/No or Number">
                        <br>
                        <br>
                    </li>
                    <li>
                        <label for="chromeBrowser">Chrome:</label>
                        <input type="text" id="chromeBrowser" placeholder="Yes/No or Number">
                        <br>
                        <br>
                    </li>
                    <li>
                        <label for="safariBrowser">Safari:</label>
                        <input type="text" id="safariBrowser" placeholder="Yes/No or Number">
                        <br>
                        <br>
                    </li>
                    <li>
                        <label for="operaBrowser">Opera:</label>
                        <input type="text" id="operaBrowser" placeholder="Yes/No or Number">
                        <br>
                        <br>
                    </li>
            </ul>

            <p class="sub-label">Choose Category Name</p>
            <ul>
            <li>
                <label for="tagCategory">Category:</label>
                <select id="tagCategory">
                    <option value="basic-elements">Basic Elements</option>
                    <option value="document-metadata">Document Metadata</option>
                    <option value="content-sectioning">Content Sectioning</option>
                    <option value="text-content">Text Content</option>
                    <option value="inline-text-semantics">Inline Text Semantics</option>
                    <option value="image-and-multimedia">Impage and Multimedia</option>
                    <option value="embedded-content">Embedded Content</option>
                    <option value="scripting">Scripting</option>
                    <option value="edits">Edits</option>
                    <option value="table-content">Table Content</option>
                    <option value="form">Form</option>
                    <option value="interactive-elements">Interactive Elements</option>
                    <option value="web-components">Web Components</option>
                    <option value="obsolete-and-deprecated-elements">Obsolete and Deprecated Elements</option>
                </select>    <br><br>
            </li>
            </ul>
            <input  type="submit" id="submit_add" name="submit_add" value="Add Tag"><br><br>
            <button type="submit" formaction="./index.html">Go To Admin Dashboard</button>
        </form>
    </div>
<br><br>
    <footer>
        <hr />
        <div class="outer_container">
            <p>
                Copyright &copy; 2015<a href="404.html"> PoweredByCoffee </a>
            </p>
        </div>
    </footer>

</body>
</html>
